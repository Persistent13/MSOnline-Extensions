[![Build Status](https://ci.appveyor.com/api/projects/status/github/persistent13/MSOnlineExt?branch=master&retina=true)](https://ci.appveyor.com/project/Persistent13/msonlineext)

# MSOnlineExt

This PowerShell module was made to ease the burden of Azure AD management in single and multi-tenant environments by addressing the gaps found in interactive use by providing autocompletion for the MSOnline cmdlets.

# Installation

Install the module with the command:

```
Install-Module -Name MSOnlineExt
```

If you do not have admin rights:

```
Install-Module -Name MSOnlineExt -Scope CurrentUser
```

# Usage

To load the module run:

```
Import-Module -Name MSOnlineExt
```

**NOTE:** In order for autocompletion to function you must run `Set-MsolTenantContext -TenantId 'TENANT GUID'`. The command may be run multiple times however autocompletion will only function on the last set TenantId.

## Features

### Functions

- **Set-MsolTenantContext** - This command will set the default tenant ID for all MSOnline cmdlets allowing you to run them with out needing to specify the tenant ID each time.

- **Remove-MsolTenantContext** - This command will remove the set default tenant ID returning you to the default behavior.

- **Get-MsolTenantContext** - This command will return the currently set default tenant ID, if any. If the default tenant ID has not been set an empty GUID of `00000000-0000-0000-0000-000000000000` will be returned.

- **Set-MSOnlineExtTelemetryOption** - This command will allow you to set the telemetry settings for the module. Once run the telemetry prompt will be disabled. Please concider enabling telemetry!

- **Get-MSOnlineExtTelemetryOption** - This command will return the current telemetry settings for them module.

### Auto-Completion

Auto-completers are PowerShell ScriptBlocks that provide Intellisense and tab-completion for PowerShell parameters. These functions require the presence of the `Register-ArgumentCompleter` PowerShell command, which is available in PowerShell version 5.0 and later.

This module provides auto completion for the following `MSOnline` parameters.

- AppPrincipalId
- DeviceId
- DomainName
- Feature
- SubscriptionId
- TenantId
- UserPrincipalName

### Telemetry

To assist with the development of this module, the option to send telemetry is available. By default no telemetry is gathered.

To enable telemetry, run the command `Set-MSOnlineExtTelemetryOption -Participate 'Yes'` and then reload the module; to disable telemetry, run the command `Set-MSOnlineExtTelemetryOption -Participate 'No'` and then reload the module.

Data gathered includes:

- PowerShell process bitness
- Operating system bitness
- PowerShell version
- PowerShell edition
- PowerShell execution context
- The time and date when a function in `MSOnlineExt` is run
- Exceptions generated by functions in `MSOnlineExt`
- Client public IP address
- Device type

Please consider enabling telemetry to help us improve MSOnlineExt!
